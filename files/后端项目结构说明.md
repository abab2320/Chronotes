
# ğŸ“˜ Chronotes åç«¯é¡¹ç›®ç»“æ„è§„èŒƒæ–‡æ¡£ï¼ˆv1.0ï¼‰

> **é€‚ç”¨èŒƒå›´ï¼š**Chronotes Web åç«¯
> **æŠ€æœ¯æ ˆï¼š**Spring Boot 3ã€Spring MVCã€Spring Data JPA / MyBatisã€Spring Securityã€JWTã€MySQL
> **ç›®çš„ï¼š**æä¾›ä¸€è‡´ã€å¯æ‰©å±•çš„é¡¹ç›®ç»“æ„ï¼Œæ–¹ä¾¿å¤šäººåä½œã€æµ‹è¯•ã€æŒç»­è¿­ä»£ã€‚

---

# 1. åç«¯æ•´ä½“ç»“æ„

```
chronotes-backend/
â”‚
â”œâ”€â”€ src/main/java/com/chronotes/
â”‚   â”œâ”€â”€ config/          # é…ç½®ç±»ï¼ˆå®‰å…¨ã€è·¨åŸŸã€æ‹¦æˆªå™¨ã€å…¨å±€é…ç½®ï¼‰
â”‚   â”œâ”€â”€ controller/      # REST API æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ dto/             # æ•°æ®ä¼ è¾“å¯¹è±¡ï¼ˆè¯·æ±‚/å“åº”ï¼‰
â”‚   â”œâ”€â”€ entity/          # æ•°æ®åº“å®ä½“ç±»
â”‚   â”œâ”€â”€ exception/       # å…¨å±€å¼‚å¸¸å¤„ç†
â”‚   â”œâ”€â”€ mapper/          # MyBatis Mapper æ¥å£ï¼ˆæˆ– repository/ å¯¹åº” JPAï¼‰
â”‚   â”œâ”€â”€ security/        # å®‰å…¨ï¼ˆJWTã€UserDetailsã€è¿‡æ»¤å™¨ï¼‰
â”‚   â”œâ”€â”€ service/         # ä¸šåŠ¡é€»è¾‘æ¥å£
â”‚   â”œâ”€â”€ service/impl/    # ä¸šåŠ¡é€»è¾‘å®ç°
â”‚   â”œâ”€â”€ util/            # å·¥å…·ç±»
â”‚   â””â”€â”€ ChronotesApplication.java
â”‚
â”œâ”€â”€ src/main/resources/
â”‚   â”œâ”€â”€ application.yml  # å…¨å±€é…ç½®
â”‚   â”œâ”€â”€ mapper/          # MyBatis XMLï¼ˆå¦‚æœä½¿ç”¨ MyBatisï¼‰
â”‚   â””â”€â”€ schema.sql       # åˆå§‹åŒ– SQLï¼ˆå¯é€‰ï¼‰
â”‚
â”œâ”€â”€ pom.xml
â””â”€â”€ README.md
```

---

# 2. å„ç›®å½•èŒè´£è¯´æ˜ï¼ˆè¯¦ç»†ï¼‰

---

## 2.1 `config/` â€”â€” å…¨å±€é…ç½®

```
config/
â”œâ”€â”€ WebConfig.java        # è·¨åŸŸã€æ‹¦æˆªå™¨é…ç½®
â”œâ”€â”€ SecurityConfig.java   # Spring Security + JWT é…ç½®
â””â”€â”€ OpenAIConfig.java     # AI æœåŠ¡é…ç½®ï¼ˆå¯é€‰ï¼‰
```

**è§„èŒƒï¼š**

* ä¸å…è®¸åœ¨ Controller ä¸­å†™è·¨åŸŸé…ç½®ï¼Œå¿…é¡»åœ¨ WebConfig ç»Ÿä¸€ç®¡ç†
* æ‰€æœ‰ Bean é…ç½®å¿…é¡»æ”¾åœ¨ config ä¸‹
* JWT è¿‡æ»¤å™¨ç»Ÿä¸€æ”¾åœ¨ security ä¸‹ï¼Œä¸æ”¾è¿™é‡Œ

---

## 2.2 `controller/` â€”â€” REST API æ§åˆ¶å±‚

```
controller/
â”œâ”€â”€ AuthController.java
â”œâ”€â”€ TaskController.java
â””â”€â”€ NoteController.java
```

**è§„èŒƒï¼š**

* æ§åˆ¶å™¨åªè´Ÿè´£ï¼š

  * å…¥å‚æ ¡éªŒ
  * è°ƒç”¨ service
  * è¿”å›ç»Ÿä¸€å“åº”æ ¼å¼
* ä¸å†™ä»»ä½•ä¸šåŠ¡é€»è¾‘
* è·¯ç”±å‘½åéµä» RESTfulï¼š

| åŠŸèƒ½   | æ–¹æ³•     | URL             |
| ---- | ------ | --------------- |
| è·å–ä»»åŠ¡ | GET    | /api/tasks      |
| æ–°å¢ä»»åŠ¡ | POST   | /api/tasks      |
| åˆ é™¤ä»»åŠ¡ | DELETE | /api/tasks/{id} |
| æ›´æ–°ä»»åŠ¡ | PUT    | /api/tasks/{id} |

---

## 2.3 `dto/` â€”â€” æ•°æ®ä¼ è¾“å¯¹è±¡

DTO æŒ‰æ¨¡å—æ‹†åˆ†ï¼š

```
dto/
â”œâ”€â”€ auth/
â”‚   â”œâ”€â”€ LoginRequest.java
â”‚   â”œâ”€â”€ RegisterRequest.java
â”‚   â””â”€â”€ AuthResponse.java
â”‚
â”œâ”€â”€ tasks/
â”‚   â”œâ”€â”€ TaskCreateRequest.java
â”‚   â”œâ”€â”€ TaskUpdateRequest.java
â”‚   â””â”€â”€ TaskResponse.java
â”‚
â””â”€â”€ notes/
    â”œâ”€â”€ NoteCreateRequest.java
    â”œâ”€â”€ NoteUpdateRequest.java
    â””â”€â”€ NoteResponse.java
```

**åŸåˆ™ï¼š**

* ç¦æ­¢ç›´æ¥ä½¿ç”¨ entity ä½œä¸ºè¯·æ±‚ä½“æˆ–å“åº”ä½“
* æ¯ä¸ªè¯·æ±‚æˆ–å“åº”éƒ½å¿…é¡»æœ‰ç‹¬ç«‹ DTO

---

## 2.4 `entity/` â€”â€” æ•°æ®åº“å®ä½“ç±»

```
entity/
â”œâ”€â”€ User.java
â”œâ”€â”€ Task.java
â””â”€â”€ Note.java
```

**è¦æ±‚ï¼š**

* åªæ”¾æ•°æ®åº“å­—æ®µæ˜ å°„
* ä¸è¦æ”¾ä¸šåŠ¡é€»è¾‘æ–¹æ³•
* å…³ç³»å†™æ¸…æ¥šä¾‹ï¼š

```java
@OneToMany(mappedBy = "user", cascade = CascadeType.ALL)
private List<Task> tasks;
```

---

## 2.5 `mapper/` æˆ– `repository/`

æ ¹æ®ä½ çš„å›¢é˜Ÿé€‰æ‹©ï¼š

### å¦‚æœä½¿ç”¨ MyBatisï¼š

```
mapper/
â”œâ”€â”€ UserMapper.java
â”œâ”€â”€ TaskMapper.java
â””â”€â”€ NoteMapper.java
```

å¯¹åº” MyBatis XML æ”¾åœ¨ï¼š

```
resources/mapper/*.xml
```

---

### å¦‚æœä½¿ç”¨ Spring Data JPAï¼š

```
repository/
â”œâ”€â”€ UserRepository.java
â”œâ”€â”€ TaskRepository.java
â””â”€â”€ NoteRepository.java
```

---

## 2.6 `service/` + `service/impl/` â€”â€” ä¸šåŠ¡é€»è¾‘å±‚

```
service/
â”œâ”€â”€ AuthService.java
â”œâ”€â”€ TaskService.java
â””â”€â”€ NoteService.java

service/impl/
â”œâ”€â”€ AuthServiceImpl.java
â”œâ”€â”€ TaskServiceImpl.java
â””â”€â”€ NoteServiceImpl.java
```

**åŸåˆ™ï¼š**

* Controller è°ƒ Serviceï¼Œä¸è°ƒç”¨ Mapper/Repository
* Service å±‚å¿…é¡»ç»†åˆ†é€»è¾‘ï¼ˆå¯ä»¥æ‹†å°æ–¹æ³•ï¼‰
* æ‰€æœ‰ä¸šåŠ¡åˆ¤æ–­å¿…é¡»å†™åœ¨ serviceï¼Œä¸å…è®¸å†™åœ¨ controller

---

## 2.7 `security/` â€”â€” æƒé™ã€å®‰å…¨ã€JWT ç›¸å…³

```
security/
â”œâ”€â”€ JwtFilter.java
â”œâ”€â”€ JwtUtils.java
â”œâ”€â”€ UserDetailsServiceImpl.java
â”œâ”€â”€ CustomUserDetails.java
â””â”€â”€ SecurityConfig.java
```

ç¡®ä¿ï¼š

* æ‰€æœ‰ Token æ ¡éªŒåœ¨ JWT Filter å®Œæˆ
* Controller ä¸å†™ token è§£æé€»è¾‘
* Token ç”± AuthService è´Ÿè´£å‘æ”¾ä¸åˆ·æ–°

---

## 2.8 `exception/` â€”â€” å…¨å±€å¼‚å¸¸å¤„ç†

```
exception/
â”œâ”€â”€ GlobalExceptionHandler.java
â””â”€â”€ CustomException.java
```

å®ç°åŠŸèƒ½ï¼š

* ç»Ÿä¸€è¿”å›é”™è¯¯æ ¼å¼
* æ•è·ä¸šåŠ¡å¼‚å¸¸
* æ•è·å…¨å±€å¼‚å¸¸

---

## 2.9 `util/` â€”â€” å·¥å…·ç±»

```
util/
â”œâ”€â”€ DateUtils.java
â”œâ”€â”€ StringUtils.java
â””â”€â”€ FileUtils.java
```

**åªå­˜æ”¾æ— ä¸šåŠ¡é€»è¾‘çš„å·¥å…·ç±»ã€‚**

---

# 3. åŒ…å‘½åè§„èŒƒ

| åˆ†ç±»         | ç¤ºä¾‹å‘½å                     |
| ---------- | ------------------------ |
| æ§åˆ¶å™¨        | XxxController            |
| æœåŠ¡æ¥å£       | XxxService               |
| æœåŠ¡å®ç°       | XxxServiceImpl           |
| æ•°æ®åº“å®ä½“      | Xxx                      |
| DTO        | XxxRequest / XxxResponse |
| Mapper     | XxxMapper                |
| Repository | XxxRepository            |

---

# 4. åç«¯æ¨¡å—åˆ†å±‚è§„åˆ™ï¼ˆå¿…é¡»éµå®ˆï¼‰

### âŒ ä¸å…è®¸çš„å†™æ³•

Controller â†’ Mapper
Component â†’ Mapper
Controller â†’ Entityï¼ˆç›´æ¥è¿”å›ï¼‰

### âœ… å”¯ä¸€æ­£ç¡®çš„ä¾èµ–å…³ç³»

```
Controller â†’ Service â†’ Mapper/Repository â†’ Database
                â†“
              DTO â†” Entity
```

---

# 5. JSON ç»Ÿä¸€è¿”å›æ ¼å¼

æ‰€æœ‰ API è¿”å›ä»¥ä¸‹ç»“æ„ï¼š

```json
{
  "code": 0,
  "message": "success",
  "data": { ... }
}
```

é”™è¯¯ç¤ºä¾‹ï¼š

```json
{
  "code": 4001,
  "message": "Invalid token"
}
```

---

# 6. æœªæ¥æ‰©å±•é¢„ç•™ç»“æ„ï¼ˆå·²è§„åˆ’ï¼‰

```
feature/
â”œâ”€â”€ ai/
â”‚   â”œâ”€â”€ EmbeddingService.java
â”‚   â”œâ”€â”€ AIAnswerService.java
â”‚   â””â”€â”€ VectorStore.java
â””â”€â”€ analytics/
    â”œâ”€â”€ StudyStatsService.java
    â””â”€â”€ TrendCalculator.java
```
